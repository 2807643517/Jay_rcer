clear;
clc;

% 画场地
DrawMap

% 定义变量
N = 5; % 控制点个数
T = 4.5;
Hz = 100;
% 控制点
% x = [-2100.0 -2615.9 -3399.3 -4809.4 -5952.3 -7445.4 -8256.5 -8800.0];
% y = [ 2100.0  1509.9   809.4   744.9   717.3   818.7  1602.1  2100.0];
x = [-2100.0 -3500.0 -5450.0 -7400.0 -8800.0];
y = [ 2100.0   550.0   200.0   550.0  2100.0];
yaw = (45:-90/(N-1):-45);
% 跑出的结果
res = [
-2110.15, 2098.92, 44.98
-2110.15, 2098.89, 44.98
-2110.10, 2098.86, 44.99
-2109.86, 2098.90, 44.99
-2109.35, 2098.94, 44.99
-2108.57, 2099.02, 44.99
-2107.61, 2099.09, 44.98
-2106.46, 2099.15, 44.97
-2105.15, 2099.21, 44.96
-2103.68, 2099.28, 44.94
-2102.16, 2099.28, 44.93
-2100.70, 2099.15, 44.93
-2099.15, 2099.02, 44.94
-2097.78, 2098.68, 44.97
-2096.61, 2098.06, 45.00
-2095.69, 2097.24, 45.05
-2095.03, 2096.15, 45.09
-2094.58, 2094.80, 45.14
-2094.38, 2093.22, 45.19
-2094.48, 2091.31, 45.24
-2094.80, 2089.20, 45.28
-2095.31, 2086.88, 45.32
-2096.00, 2084.35, 45.35
-2096.92, 2081.61, 45.36
-2098.02, 2078.74, 45.36
-2099.34, 2075.80, 45.37
-2100.80, 2072.91, 45.38
-2102.51, 2069.84, 45.38
-2104.33, 2066.67, 45.35
-2106.35, 2063.53, 45.33
-2108.65, 2060.11, 45.31
-2110.97, 2057.10, 45.27
-2113.62, 2053.84, 45.21
-2116.58, 2050.75, 45.14
-2119.76, 2047.83, 45.10
-2123.09, 2044.88, 45.06
-2126.64, 2041.76, 44.99
-2130.12, 2038.51, 44.92
-2134.20, 2035.03, 44.87
-2138.31, 2031.41, 44.81
-2142.70, 2027.48, 44.74
-2147.47, 2023.30, 44.69
-2152.45, 2018.68, 44.65
-2157.68, 2013.75, 44.64
-2163.17, 2008.84, 44.65
-2168.71, 2003.67, 44.64
-2174.58, 1998.10, 44.64
-2181.04, 1992.19, 44.67
-2187.84, 1986.08, 44.70
-2194.58, 1979.91, 44.71
-2201.65, 1973.42, 44.72
-2209.25, 1966.42, 44.78
-2216.72, 1959.12, 44.82
-2224.61, 1951.74, 44.83
-2232.81, 1944.33, 44.88
-2241.58, 1936.39, 44.95
-2250.50, 1928.22, 44.99
-2259.44, 1919.94, 45.01
-2268.71, 1911.56, 45.06
-2278.32, 1902.86, 45.10
-2287.67, 1893.85, 45.12
-2297.54, 1884.40, 45.14
-2307.72, 1874.36, 45.19
-2318.04, 1864.52, 45.20
-2328.37, 1854.90, 45.18
-2339.08, 1843.85, 45.17
-2349.90, 1832.78, 45.15
-2360.64, 1822.07, 45.13
-2372.09, 1810.64, 45.12
-2383.58, 1799.34, 45.08
-2395.08, 1788.16, 45.03
-2407.03, 1777.36, 44.95
-2418.81, 1765.76, 44.90
-2430.89, 1753.70, 44.82
-2442.70, 1741.48, 44.75
-2455.22, 1729.50, 44.68
-2467.68, 1716.96, 44.62
-2480.52, 1704.11, 44.55
-2493.80, 1690.39, 44.55
-2506.83, 1676.58, 44.45
-2520.60, 1662.82, 44.35
-2533.51, 1649.61, 44.23
-2547.11, 1635.81, 44.18
-2561.46, 1621.54, 44.07
-2575.84, 1606.13, 43.94
-2590.52, 1591.44, 43.82
-2604.81, 1576.90, 43.59
-2619.70, 1561.86, 43.45
-2635.09, 1546.47, 43.33
-2649.47, 1530.50, 43.15
-2664.19, 1514.90, 42.94
-2679.87, 1498.62, 42.81
-2695.85, 1481.42, 42.78
-2711.98, 1464.64, 42.62
-2728.86, 1446.11, 42.61
-2745.20, 1428.79, 42.53
-2761.05, 1411.15, 42.38
-2777.63, 1393.27, 42.24
-2794.62, 1374.79, 42.16
-2811.33, 1356.89, 42.00
-2826.11, 1340.59, 41.31
-2841.11, 1324.31, 40.64
-2859.29, 1305.18, 40.54
-2877.95, 1286.10, 40.46
-2895.66, 1266.53, 40.28
-2914.79, 1245.91, 40.18
-2934.18, 1225.56, 40.12
-2953.17, 1205.86, 39.99
-2972.57, 1185.55, 39.85
-2992.37, 1165.37, 39.74
-3013.18, 1146.18, 39.58
-3033.17, 1125.89, 39.41
-3054.27, 1105.62, 39.24
-3075.40, 1085.75, 39.07
-3097.27, 1066.17, 38.91
-3118.58, 1046.05, 38.67
-3140.64, 1026.81, 38.45
-3162.51, 1007.99, 38.26
-3184.16, 989.19, 38.10
-3206.10, 970.84, 37.86
-3228.61, 952.97, 37.70
-3250.00, 936.18, 37.32
-3272.36, 919.96, 36.87
-3295.49, 903.23, 36.66
-3318.55, 887.29, 36.45
-3341.90, 870.58, 36.25
-3364.47, 854.61, 36.02
-3388.82, 839.33, 35.80
-3412.91, 824.73, 35.59
-3436.98, 809.96, 35.43
-3460.47, 794.80, 35.19
-3484.33, 779.74, 34.93
-3508.81, 765.04, 34.65
-3532.09, 751.30, 34.38
-3555.85, 737.83, 34.08
-3579.96, 724.74, 33.73
-3604.14, 711.03, 33.41
-3627.75, 698.52, 33.06
-3651.47, 686.16, 32.71
-3674.99, 674.04, 32.35
-3698.23, 661.59, 31.99
-3722.04, 649.84, 31.59
-3746.06, 638.15, 31.19
-3769.26, 626.88, 30.77
-3792.31, 615.60, 30.36
-3815.30, 604.50, 29.94
-3838.92, 592.49, 29.53
-3861.64, 580.97, 29.11
-3885.00, 570.42, 28.69
-3908.49, 560.15, 28.26
-3931.66, 550.15, 27.82
-3955.41, 539.74, 27.43
-3978.86, 529.12, 27.04
-4002.55, 519.48, 26.61
-4025.75, 509.52, 26.21
-4050.10, 499.92, 25.84
-4074.56, 489.77, 25.45
-4098.98, 481.19, 25.08
-4123.18, 472.81, 24.74
-4147.60, 464.46, 24.40
-4171.98, 456.74, 24.05
-4196.66, 448.65, 23.68
-4220.89, 440.36, 23.34
-4245.98, 432.64, 22.99
-4271.27, 426.17, 22.67
-4296.13, 420.30, 22.36
-4320.96, 414.37, 22.08
-4346.38, 408.47, 21.78
-4371.71, 403.28, 21.49
-4396.16, 398.07, 21.20
-4421.55, 393.44, 20.93
-4447.81, 389.04, 20.63
-4473.84, 384.75, 20.34
-4499.77, 380.95, 20.05
-4525.06, 377.47, 19.72
-4551.12, 374.57, 19.42
-4576.52, 371.51, 19.15
-4602.30, 369.24, 18.83
-4627.86, 367.14, 18.48
-4657.15, 363.76, 18.81
-4682.57, 362.10, 18.53
-4707.41, 360.47, 18.18
-4732.55, 359.09, 17.83
-4756.74, 357.65, 17.46
-4781.19, 357.14, 17.07
-4805.75, 356.98, 16.68
-4829.47, 356.82, 16.26
-4853.63, 356.44, 15.88
-4877.23, 355.94, 15.44
-4900.80, 355.79, 15.03
-4923.52, 355.63, 14.64
-4947.01, 355.63, 14.25
-4970.85, 354.88, 13.85
-4994.67, 353.85, 13.47
-5018.48, 352.71, 13.08
-5042.07, 351.27, 12.70
-5072.31, 348.20, 13.34
-5101.29, 344.19, 13.90
-5125.75, 342.06, 13.59
-5150.44, 339.69, 13.26
-5175.12, 337.09, 12.91
-5199.88, 334.32, 12.52
-5224.47, 331.40, 12.13
-5249.21, 329.03, 11.75
-5273.88, 327.05, 11.37
-5297.85, 324.61, 11.01
-5323.18, 321.85, 10.69
-5349.94, 320.00, 10.38
-5375.82, 318.51, 9.99
-5401.03, 316.73, 9.59
-5427.16, 314.10, 9.25
-5453.52, 312.69, 8.92
-5479.14, 310.90, 8.55
-5505.22, 309.79, 8.17
-5531.73, 309.01, 7.80
-5558.38, 308.67, 7.45
-5584.76, 308.07, 7.09
-5611.03, 308.26, 6.76
-5637.50, 308.71, 6.42
-5663.10, 308.63, 6.07
-5690.03, 308.88, 5.72
-5716.80, 310.01, 5.40
-5743.11, 312.27, 5.07
-5768.64, 314.81, 4.67
-5794.68, 316.82, 4.31
-5821.11, 318.99, 3.97
-5846.31, 320.79, 3.60
-5872.63, 323.77, 3.24
-5899.34, 326.58, 2.90
-5926.03, 329.72, 2.53
-5953.28, 332.14, 2.19
-5979.86, 335.24, 1.88
-6005.67, 338.99, 1.49
-6031.14, 342.33, 1.10
-6057.76, 346.44, 0.76
-6085.02, 350.69, 0.53
-6111.18, 355.07, 0.18
-6137.04, 360.11, -0.21
-6163.23, 364.87, -0.55
-6189.50, 369.60, -0.90
-6214.81, 374.03, -1.25
-6241.55, 378.91, -1.60
-6268.00, 384.62, -1.92
-6294.09, 390.28, -2.27
-6320.08, 396.10, -2.60
-6346.15, 402.14, -2.90
-6372.33, 408.03, -3.24
-6397.96, 413.53, -3.59
-6424.45, 419.86, -3.91
-6451.09, 425.99, -4.27
-6477.40, 432.23, -4.64
-6504.05, 438.04, -5.01
-6529.90, 444.90, -5.41
-6555.97, 451.87, -5.76
-6581.38, 458.22, -6.10
-6607.30, 465.22, -6.45
-6633.31, 472.69, -6.77
-6659.41, 479.85, -7.09
-6685.29, 486.74, -7.41
-6710.89, 494.09, -7.74
-6736.41, 501.52, -8.08
-6762.11, 507.97, -8.40
-6787.66, 515.38, -8.74
-6813.41, 523.54, -9.00
-6838.94, 531.29, -9.34
-6859.82, 538.05, -10.40
-6885.17, 545.83, -10.74
-6909.89, 554.26, -11.09
-6933.86, 562.29, -11.44
-6958.32, 570.95, -11.75
-6983.26, 579.89, -12.08
-6995.89, 588.21, -12.42
-7020.57, 597.06, -12.73
-7044.57, 606.53, -12.98
-7068.45, 616.00, -13.29
-7091.91, 625.61, -13.61
-7114.74, 634.82, -13.92
-7138.41, 644.95, -14.20
-7161.42, 655.13, -14.52
-7183.81, 665.47, -14.85
-7206.54, 675.90, -15.14
-7229.14, 686.35, -15.38
-7250.57, 697.14, -15.68
-7271.11, 708.03, -16.00
-7292.90, 719.15, -16.30
-7314.45, 730.35, -16.61
-7335.34, 741.56, -16.94
-7357.26, 752.65, -17.26
-7378.47, 763.94, -17.56
-7399.48, 775.13, -17.89
-7419.79, 786.28, -18.22
-7439.99, 797.97, -18.54
-7460.33, 810.21, -18.85
-7480.36, 822.73, -19.13
-7500.44, 835.17, -19.41
-7520.60, 847.58, -19.68
-7540.61, 859.92, -19.98
-7560.95, 871.30, -20.27
-7581.11, 884.08, -20.55
-7601.26, 897.00, -20.84
-7621.05, 910.26, -21.15
-7640.61, 923.69, -21.45
-7661.06, 936.49, -21.70
-7681.40, 949.88, -21.97
-7701.09, 963.00, -22.25
-7720.48, 976.92, -22.54
-7740.65, 991.18, -22.81
-7761.35, 1005.62, -23.06
-7781.65, 1020.45, -23.35
-7801.95, 1035.88, -23.67
-7822.25, 1051.50, -23.96
-7842.38, 1067.42, -24.25
-7862.09, 1082.94, -24.52
-7882.11, 1099.79, -24.84
-7902.13, 1118.12, -25.15
-7922.21, 1136.09, -25.39
-7942.30, 1153.75, -25.64
-7962.68, 1172.40, -25.86
-7982.89, 1191.55, -26.13
-8003.46, 1209.90, -26.39
-8023.72, 1229.87, -26.59
-8043.86, 1250.17, -26.81
-8063.93, 1270.39, -27.02
-8084.18, 1291.44, -27.21
-8104.24, 1312.46, -27.44
-8124.32, 1334.41, -27.65
-8143.90, 1356.13, -27.83
-8163.39, 1379.02, -27.96
-8182.87, 1401.86, -28.13
-8202.78, 1425.16, -28.30
-8222.50, 1448.34, -28.48
-8241.71, 1472.00, -28.69
-8260.83, 1495.92, -28.92
-8279.77, 1519.74, -29.15
-8297.63, 1542.19, -29.39
-8315.32, 1566.01, -29.68
-8332.61, 1589.89, -29.97
-8349.28, 1613.72, -30.26
-8366.42, 1637.33, -30.56
-8382.24, 1660.79, -30.84
-8397.50, 1684.02, -31.14
-8412.05, 1706.44, -31.46
-8425.55, 1730.21, -31.80
-8439.48, 1753.69, -32.15
-8453.38, 1777.16, -32.50
-8466.12, 1800.37, -32.85
-8478.64, 1823.79, -33.21
-8491.07, 1846.90, -33.55
-8503.26, 1869.96, -33.93
-8514.05, 1891.98, -34.32
-8524.67, 1914.73, -34.71
-8534.88, 1937.00, -35.09
-8545.00, 1959.04, -35.47
-8555.10, 1969.97, -35.86
-8565.07, 1991.80, -36.22
-8574.83, 2013.46, -36.59
-8584.32, 2034.96, -36.97
-8593.10, 2055.34, -37.32
-8602.43, 2076.25, -37.67
-8611.85, 2096.58, -38.00
-8620.52, 2116.51, -38.37
-8629.27, 2136.77, -38.74
-8637.95, 2156.53, -39.05
-8647.05, 2176.16, -39.34
-8655.20, 2194.01, -39.68
-8663.36, 2212.21, -40.01
-8672.13, 2229.55, -40.29
-8680.94, 2246.60, -40.60
-8689.04, 2263.04, -40.96
-8697.03, 2279.04, -41.28
-8704.49, 2294.73, -41.51
-8712.54, 2310.01, -41.76
-8719.93, 2325.34, -42.01
-8727.40, 2340.17, -42.26
-8734.57, 2354.38, -42.49
-8741.47, 2368.39, -42.76
-8748.06, 2381.59, -43.02
-8754.16, 2394.32, -43.28
-8760.42, 2407.05, -43.59
-8765.63, 2418.76, -43.88
-8770.79, 2430.30, -44.18
-8775.98, 2441.44, -44.48
-8781.67, 2452.37, -44.78
-8787.04, 2462.39, -45.08
-8792.13, 2472.48, -45.32
-8796.99, 2481.74, -45.64
-8801.75, 2489.40, -45.97
-8806.76, 2496.87, -46.22
-8811.95, 2504.11, -46.54
-8816.64, 2511.10, -46.91
-8821.05, 2517.43, -47.28
-8825.15, 2523.08, -47.72
-8829.11, 2528.46, -48.10
-8832.97, 2533.29, -48.47
-8836.60, 2537.35, -48.93
-8840.35, 2541.15, -49.39
-8843.85, 2544.77, -49.80
-8846.94, 2547.86, -50.25
-8849.95, 2550.32, -50.70
-8853.17, 2552.43, -51.14
-8855.99, 2554.22, -51.62
-8858.72, 2555.64, -52.06
-8861.02, 2556.22, -52.55
-8863.17, 2556.59, -53.00
-8865.48, 2557.09, -53.45
-8867.62, 2556.98, -53.95
-8869.05, 2555.91, -54.55
-8870.61, 2554.44, -55.06
-8872.17, 2552.94, -55.55
-8873.60, 2550.83, -56.11
-8874.75, 2548.35, -56.68
-8875.78, 2545.36, -57.24
-8876.62, 2542.05, -57.82
-8877.30, 2538.27, -58.41
-8877.80, 2533.84, -59.02
-8878.28, 2529.23, -59.60
-8878.42, 2524.15, -60.25
-8878.56, 2518.63, -60.86
-8878.45, 2512.77, -61.48
-8878.26, 2506.26, -62.17
-8877.95, 2499.48, -62.85
-8877.53, 2492.34, -63.52
-8876.92, 2484.90, -64.15
-8876.39, 2477.12, -64.83
-8875.70, 2468.60, -65.52
-8874.90, 2459.41, -66.25
-8874.23, 2449.84, -66.94
-8873.48, 2440.22, -67.65
-8872.48, 2429.98, -68.35
-8871.53, 2419.53, -69.10
-8870.24, 2407.90, -69.87
-8869.03, 2396.68, -70.63
-8867.90, 2384.77, -71.34
-8866.88, 2372.81, -71.70
-8865.57, 2359.89, -72.89
-8863.75, 2346.29, -73.31
-8862.44, 2332.69, -74.11
-8861.10, 2318.46, -74.94
-8859.69, 2304.40, -75.74
-8858.46, 2289.88, -76.53
-8856.79, 2274.16, -77.36
-8855.55, 2258.70, -78.14
-8854.11, 2242.59, -78.97
-8852.80, 2225.68, -79.86
-8851.26, 2208.13, -80.78
-8849.25, 2191.21, -81.62
-8847.44, 2173.82, -82.36
-8845.27, 2156.66, -83.04
-8843.15, 2139.45, -83.64

];
res = res';

C = [x; y];
Speedx = threeB(C, T, Hz, 1);
Speedy = threeB(C, T, Hz, 2);
Speedyaw = threeB(yaw, T, Hz, 1);
plot(Speedx.y , Speedy.y ,'b--','LineWidth',1);
plot(res(1,:), res(2,:), 'r-','LineWidth',1);

figure(1);
plot(1:length(Speedyaw.y), Speedyaw.y, '-.', 1:length(res), res(3,:));
xlabel('yaw轴');

figure(3);
subplot(3,1,1);grid on;
plot(1:length(Speedx.y), res(1,:)-Speedx.y);
xlabel('x轴误差');
subplot(3,1,2);grid on;
plot(1:length(Speedy.y), res(2,:)-Speedy.y);
xlabel('y轴误差');
subplot(3,1,3);grid on;
plot(1:length(Speedyaw.y), res(3,:)-Speedyaw.y);
xlabel('yaw轴误差');


